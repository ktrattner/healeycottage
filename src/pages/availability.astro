---
import Base from "../layouts/Base.astro";
import rooms from "../content/rooms.json";
---

<Base title="Availability | Healey Cottage">
  <header class="head">
    <div>
      <h1>Availability</h1>
      <p class="muted">
        Public calendars show <b>busy blocks only</b> (no guest names or details).
        If a date looks open, submit a request and weâ€™ll confirm by email.
      </p>
    </div>

    <a class="btn primary" href="/request">Request a stay</a>
  </header>

  <div class="grid" role="list">
    {rooms.map((r) => (
      <section class="card room" role="listitem">
        <div class="top">
          <div>
            <h2>{r.name}</h2>
            <p class="muted meta">Busy blocks only</p>
          </div>
          <div class="cardActions">
            <a class="btn small" href={`/rooms/${r.slug}`}>Room details</a>
            <a class="btn primary small" href={`/request?room=${r.slug}`}>Request {r.name}</a>
          </div>
        </div>

        <iframe
          class="frame"
          src={r.calendarEmbedUrl}
          width="100%"
          height="640"
          loading="lazy"
          referrerpolicy="no-referrer-when-downgrade"
          title={`${r.name} availability`}
        ></iframe>
      </section>
    ))}
  </div>

  <style>
    .head {
      display: flex;
      align-items: flex-start;
      justify-content: space-between;
      gap: 14px;
      margin-top: 10px;
      flex-wrap: wrap;
    }

    h1 { margin: 0; }
    .head .muted { margin: 8px 0 0; max-width: 80ch; }

    .grid {
      margin-top: 18px;
      display: grid;
      gap: 14px;
      grid-template-columns: 1fr;
      align-items: start;
    }

    .room {
      padding: 14px;
    }

    .top {
      display: flex;
      align-items: flex-start;
      justify-content: space-between;
      gap: 12px;
      margin-bottom: 10px;
    }

    .top h2 {
      margin: 0;
      font-size: 18px;
    }

    .meta {
      margin: 6px 0 0;
      font-size: 13px;
    }

    .cardActions {
      display: flex;
      gap: 10px;
      align-items: center;
      justify-content: flex-end;
      flex-wrap: wrap;
      margin-top: 4px;
    }

    .btn.small {
      padding: 8px 10px;
      font-size: 13px;
      border-radius: 12px;
      white-space: nowrap;
    }

    .frame {
      border: 1px solid rgba(0,0,0,.12);
      border-radius: 14px;
      overflow: hidden;
      background: #fff;
    }
    .frame { border: 0; }
    .frame { border-radius: 14px; }
  </style>
</Base>