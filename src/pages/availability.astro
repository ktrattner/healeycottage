---
import Base from "../layouts/Base.astro";
import rooms from "../content/rooms.json";
---

<Base title="Availability | Healey Cottage">
  <header class="head">
    <div>
      <h1>Availability</h1>
      <p class="muted">
        Public calendars show <b>busy blocks only</b> (no guest names or details).
        If a date looks open, submit a request and weâ€™ll confirm by email.
      </p>
    </div>

    <a class="btn" href="/request">Request a stay</a>
  </header>

  <div class="grid" role="list">
    {rooms.map((r) => (
      <section class="card room" role="listitem">
        <div class="top">
          <div>
            <h2>{r.name}</h2>
            <p class="muted meta">Busy blocks only</p>
          </div>
          <a class="link" href={`/rooms/${r.slug}`}>Room details</a>
        </div>

        <iframe
          class="frame"
          src={r.calendarEmbedUrl}
          width="100%"
          height="640"
          loading="lazy"
          referrerpolicy="no-referrer-when-downgrade"
          title={`${r.name} availability`}
        ></iframe>

        <div class="actions">
          <a class="mini" href={`/request?room=${r.slug}`}>Request {r.name}</a>
        </div>
      </section>
    ))}
  </div>

  <style>
    .head {
      display: flex;
      align-items: flex-start;
      justify-content: space-between;
      gap: 14px;
      margin-top: 10px;
      flex-wrap: wrap;
    }

    h1 { margin: 0; }
    .head .muted { margin: 8px 0 0; max-width: 80ch; }

    .btn {
      display: inline-flex;
      align-items: center;
      justify-content: center;
      padding: 10px 14px;
      border-radius: 12px;
      border: 1px solid rgba(0,0,0,.12);
      background: #111;
      color: #fff;
      font-weight: 600;
      text-decoration: none;
      white-space: nowrap;
    }
    .btn:hover { filter: brightness(1.05); text-decoration: none; }

    .grid {
      margin-top: 18px;
      display: grid;
      gap: 14px;
      grid-template-columns: 1fr;
      align-items: start;
    }

    .room {
      padding: 14px;
    }

    .top {
      display: flex;
      align-items: flex-start;
      justify-content: space-between;
      gap: 12px;
      margin-bottom: 10px;
    }

    .top h2 {
      margin: 0;
      font-size: 18px;
    }

    .meta {
      margin: 6px 0 0;
      font-size: 13px;
    }

    .link {
      text-decoration: none;
      opacity: .85;
      font-size: 13px;
      white-space: nowrap;
      padding: 6px 8px;
      border-radius: 10px;
      border: 1px solid rgba(0,0,0,.12);
    }
    .link:hover { opacity: 1; text-decoration: none; border-color: rgba(0,0,0,.22); }

    .frame {
      border: 1px solid rgba(0,0,0,.12);
      border-radius: 14px;
      overflow: hidden;
    }

    .actions {
      margin-top: 10px;
      display: flex;
      justify-content: flex-end;
    }

    .mini {
      text-decoration: none;
      font-size: 13px;
      padding: 8px 10px;
      border-radius: 12px;
      border: 1px solid rgba(0,0,0,.12);
      background: rgba(0,0,0,.04);
    }
    .mini:hover { background: rgba(0,0,0,.06); text-decoration: none; }
  </style>
</Base>